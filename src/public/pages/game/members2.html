<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Game App</title>
    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="../../css/bootstrap.min.css">
    <link rel="stylesheet" href="../../css/styles.css" type="text/css">
    <script src="/socket.io/socket.io.js"></script>
    <script src="../../js/jquery.min.js"></script>
</head>

<body>

    <div class="app">
        <nav class="navbar navbar-expand-lg navbar-dark bg-brand dashboard-header">
            <div class="container">
                <a class="navbar-brand" href="../dashboard.html">Kabooter</a>
                <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent"
                    aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <div class="collapse navbar-collapse" id="navbarSupportedContent">
                    <ul class="navbar-nav mr-auto"></ul>

                    <ul class="navbar-nav">
                        <li class="nav-item dropdown">
                            <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true"
                                aria-expanded="false">
                                Hi,
                                <span id='dis-name'></span>
                            </a>
                            <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                                <a class="dropdown-item" href="#">View Profile</a>
                                <!--<a class="dropdown-item" href="#">Edit Profile</a>-->
                                <div class="dropdown-divider"></div>
                                <a class="dropdown-item" href="#">Logout</a>
                            </div>
                        </li>
                    </ul>
                </div>
            </div>
        </nav>
        <div class="row mt-5">
            <div class="col-lg-8 offset-lg-2 col-md-10 offset-md-1 my-card p-5">
                <span id="success" class="success"></span>
                <span id="error" class="error"></span>
                <span id="feedback" class="warning"></span>
                <!--<span id="success" class="success"></span>-->
            </div>
        </div>

        <div class="row mt-5" id='step1'>
            <div class="col-lg-8 offset-lg-2 col-md-10 offset-md-1 my-card p-5">
                <form>
                    <div class="form-group pt-3">
                        <label>Select Quiz</label>
                        <select class="form-control" id="quiz">

                        </select>
                        <button onclick="startQuizAdmin(event);">Start Quiz</button>
                    </div>
                </form>
            </div>
        </div>

        <div id="step2">
            <div class="container mt-5">
                <div class="text-center">
                    <h1 class="font-weight-light text-brand-light">
                        <span id='quiztitle'></span>
                    </h1>
                    <p class="text-secondary col-md-8 offset-md-2">
                        <span id='quizdescription'></span>
                    </p>
                </div>
                <div class="row mt-4">
                    <div class="col-lg-8 offset-lg-2 col-md-10 offset-md-1">
                        <div class="alert alert-warning text-center font-weight-bold">Visit
                            <a href="https://kabooter.it">kabooter.it</a> to join the game and insert the code below
                            <h1 class="font-weight-bold pt-3 text-dark">
                                <span id='pin'></span>
                            </h1>
                        </div>
                    </div>
                    <div class="col-lg-8 offset-lg-2 col-md-10 offset-md-1 text-center mt-3">
                        <h4 class="text-secondary">Ready to play?</h4>
                        <a id="goToQuestionBtn" onclick='showquest()' class="btn btn-brand-light mt-2 px-4">Start</a>
                        <hr class="mt-5">
                    </div>
                    <div class="col-lg-8 offset-lg-2 col-md-10 offset-md-1 text-center mt-3">
                        <h5>
                            <strong>
                                <span id='nplayers'></span>
                            </strong> users currently playing</h5>
                        <div class="row text-center mt-4">
                            <!--                                <div class="col-md-3 py-2 bg-light border border-white">
                                                                    Olajhidey
                                                                    <strong class="text-secondary">OLA1223</strong>
                                                                </div>-->
                            <!--                                <div class="col-md-3 py-2 bg-light border border-white">
                                                                                                    Dare
                                                                                                    <strong class="text-secondary">DRE1223</strong>
                                                                                                </div>
                                                                                                <div class="col-md-3 py-2 bg-light border border-white">
                                                                                                    Funmi
                                                                                                    <strong class="text-secondary">FUN1223</strong>
                                                                                                </div>
                                                                                                <div class="col-md-3 py-2 bg-light border border-white">
                                                                                                    Tayo
                                                                                                    <strong class="text-secondary">TY1223</strong>
                                                                                                </div>
                                                                                                <div class="col-md-3 py-2 bg-light border border-white">
                                                                                                    Olayinka
                                                                                                    <strong class="text-secondary">OLA1223</strong>
                                                                                                </div>
                                                                                                <div class="col-md-3 py-2 bg-light border border-white">
                                                                                                    Mercy
                                                                                                    <strong class="text-secondary">MER1223</strong>
                                                                                                </div>-->
                            <!--                                <div class="col-md-3 py-2 bg-light border border-white">
                                                                    Emmanuel
                                                                    <strong class="text-secondary">EMM1223</strong>
                                                                </div>-->
                        </div>
                    </div>
                </div>
            </div>

        </div>

        <div id="disquest" hidden>
            <div class="container mt-5">
                <div class="text-center">
                    <h1 class="font-weight-light text-brand-light">
                        <span id='quiztitle'>
                    </h1>
                    <p class="text-secondary col-md-8 offset-md-2">
                        <span id='quizdescription'></span>
                    </p>
                    <hr>
                </div>
                <div class="row mt-4">
                    <div class="col-lg-8 offset-lg-2 col-md-10 offset-md-1 text-center mt-3">
                        <h4 class="text-secondary">
                            <strong>Question
                                <span id="quizid"></span>
                            </strong> of
                            <span id="quiztotal"></span>
                        </h4>
                        <p class="mt-4">
                            <span id='quest'></span>
                            <br>
                            <span class="font-weight-bold text-brand-light font-small">
                                <span id='timeLimit'></span> seconds</span>
                        </p>
                        <div class="row">
                            <div class="col-md-6 my-2">
                                <h5>A.
                                    <span id='opt1'></span>
                                </h5>
                            </div>
                            <div class="col-md-6 my-2">
                                <h5>B.
                                    <span id='opt2'></span>
                                </h5>
                            </div>
                            <div class="col-md-6 my-2">
                                <h5>C.
                                    <span id='opt3'></span>
                                </h5>
                            </div>
                            <div class="col-md-6 my-2">
                                <h5>D.
                                    <span id='opt4'></span>
                                </h5>
                            </div>
                        </div>
                        <a role="button" onclick='loadNextQuestion(e)' class="btn btn-brand my-4 px-4">Next</a>
                    </div>
                </div>
            </div>
        </div>
        <div id="results" hidden>
            <div class="container mt-5">
                <span id="error"></span>
                <div class="text-center">
                    <h1 class="font-weight-light text-brand-light">Results</h1>
                </div>
                <div class="row mt-4">
                    <div class="col-lg-8 offset-lg-2 col-md-10 offset-md-1 my-card py-4">
                        <table class="table table-hover table-borderless">
                            <thead class="thead-dark">
                                <tr>
                                    <th scope="col" class="font-bold">#</th>
                                    <th scope="col" class="font-bold">Player</th>
                                    <th scope="col" class="font-bold">Score</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <th scope="row">1</th>
                                    <td>Olajide</td>
                                    <td>1092</td>
                                </tr>
                                <tr>
                                    <th scope="row">2</th>
                                    <td>Dare</td>
                                    <td>1005</td>
                                </tr>
                                <tr>
                                    <th scope="row">2</th>
                                    <td>Vivian</td>
                                    <td>980</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

        <div id="scoreboard" hidden="">
            <div class="container mt-5">
                <span id="error"></span>
                <div class="text-center">
                    <h1 class="font-weight-light text-brand-light">Scoreboard</h1>
                </div>
                <div class="row mt-4">
                    <div class="col-lg-8 offset-lg-2 col-md-10 offset-md-1 my-card p-4">
                        <h3 class="text-center mb-4">
                            <strong>Question
                                <span id="quizid"></span>
                            </strong> of
                            <span id="quiztotal"></span>
                        </h3>
                        <h4>Who is the President of Nigeria
                            <br class="d-block d-md-none">
                            <a role="button" href="#" class="float-left float-md-right btn btn-brand font-small px-4">Next</a>
                        </h4>
                        <canvas id="graph-div" class="py-5 text-center text-secondary">Graph here...</canvas>
                        <div class="row">
                            <div class="col-6 p-5 text-center bg-blue">
                                <h4 class="font-bold">A. Buhari</h4>
                            </div>
                            <div class="col-6 p-5 text-center bg-red text-white">
                                <h4 class="font-bold">B. Jonathan</h4>
                            </div>
                            <div class="col-6 p-5 text-center bg-pink text-white">
                                <h4 class="font-bold">C. Obasanjo</h4>
                            </div>
                            <div class="col-6 p-5 text-center bg-yellow">
                                <h4 class="font-bold">D. Falz</h4>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script src="/general.js"></script>
    <script src="/quizadmin.ui.js"></script>
    <script src="/quizadmin.js"></script>
    <script>
        function startQuizAdmin(e) {
            e.preventDefault();
            const data = {
                quizId: $("#quiz").val()
            };
            console.log("calling startQuizAdmin with data: ");
            console.log(data);
            const baseUrl = window.location.origin;
            $.ajax({
                type: 'POST',
                url: baseUrl + '/api/user/quizruns/create',
                data: data,
                beforeSend: function (xhr) {
                    const authToken = "Bearer " + getAuthToken();
                    xhr.setRequestHeader("Authorization", authToken);
                },
                success: function (result) {
                    //                    onGetQuizRunInfo(result);
                    onGetQuizRunInfo(result);
                },
                error: function (error) {
                    console.log("Status: " + error.status + " Message: " + error.statusText);
                    console.log(error);
                }
            });
        }
        function loadNextQuestion(e) {
            e.preventDefault();
            getNextQuestion();
        }
        $(function () {
            const baseUrl = window.location.origin;
            $.ajax({
                type: 'GET',
                url: baseUrl + '/api/user/quizzes',
                beforeSend: function (xhr) {
                    const authToken = "Bearer " + getAuthToken();
                    xhr.setRequestHeader("Authorization", authToken);
                },
                success: function (result) {
                    console.log("Result from " + baseUrl + "/api/user/quizzes");
                    console.log(result);
                    let options = "";
                    if (result) {
                        result.forEach(function (r) {
                            options += ('<option value="' + r.id + '">' + r.title + '</option>');
                        });
                    }
                    $("#quiz").html(options);
                },
                error: function (error) {
                    console.log("Status: " + error.status + " Message: " + error.statusText);
                    console.log(error);
                }
            });
        });                                                            </script>

    <script>
        function showquest() {
            $('#step2').hide();
            $('#disquest').show();
        }
    </script>
     <script src="../../js/admin.js"></script>
     <!--<script src="../../pages/game/members.html"></sscript>-->
     <!-- Popper JS -->
     <script src="../../js/popper.min.js"></script>
     <script src="../../js/Chart.min.js"></script>
     <script src="../../js/bootstrap.min.js"></script>
    <!--        <script>
        
                            var ctx = document.getElementById('graph-div').getContext('2d');
                            var chart = new Chart(ctx, {
                            type: 'bar',
                                    data: {
                                    labels: ["A. Buhari", "B. Jonathan", "C. Obasanjo", "D. Falz"],
                                            datasets: [{
                                            label: "Who is the President of Nigeria",
                                                    data: [10, 7, 5, 3],
                                                    backgroundColor: ['aqua', 'red', 'palevioletred', 'yellow']
                                            }]
                                    },
                                    options: {}
                            });
        
                </script>-->
</body>

</html>